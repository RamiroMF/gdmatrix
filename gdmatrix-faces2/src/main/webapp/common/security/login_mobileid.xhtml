<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml"
      xmlns:h="http://java.sun.com/jsf/html"
      xmlns:f="http://java.sun.com/jsf/core"
      xmlns:ui="http://java.sun.com/jsf/facelets"
      xmlns:p="http://primefaces.org/ui"
      xmlns:sf="http://faces.santfeliu.org"
      xmlns:t="http://myfaces.apache.org/tomahawk"
      lang="#{userSessionBean.viewLanguage}">
  <f:view locale="#{userSessionBean.viewLocale}">
      <f:loadBundle basename="org.santfeliu.web.resources.WebBundle" var="webBundle"/>
      <f:loadBundle basename="org.santfeliu.security.web.resources.SecurityBundle" var="securityBundle"/>
      <f:loadBundle basename="org.santfeliu.security.web.resources.MobileIdBundle" var="mobileIdBundle"/>
      <h:head>
        <meta content="text/html;charset=UTF-8" />
        <meta name="viewport" content="width=device-width" />
        <title>${loginBean.loginTitle}</title>
        <link rel="stylesheet" type="text/css"
          href="${pageContext.request.contextPath}/common/security/css/security.css?v=${applicationBean.resourcesVersion}" />
        <link rel="stylesheet" type="text/css"
              href="${pageContext.request.contextPath}/common/security/css/mobileid.css?v=${applicationBean.resourcesVersion}" />
      </h:head>
      <h:body class="loginPage">
        <sf:heading level="1" styleClass="element-invisible">
          <h:outputText value="MobileID" />        
        </sf:heading>        
        
        <h:form id="mainform" enctype="multipart/form-data">

          <t:div styleClass="loginMobile">

            <t:div rendered="#{userSessionBean.selectedMenuItem.properties.login_mobileid_headerDocId != null}">
              <sf:browser url="/documents/#{userSessionBean.selectedMenuItem.properties.login_mobileid_headerDocId}" 
                          port="#{applicationBean.defaultPort}"
                          translator="#{userSessionBean.translator}"
                          translationGroup="mobileId" />
            </t:div>

            <t:panelGroup rendered="#{not mobileIdBean.waitingForPin}" styleClass="panel enter_id_number">
              <h:outputLabel value="#{mobileIdBundle.docType}:" for="docType" />
              <t:selectOneMenu id="docType" value="#{mobileIdBean.docType}" styleClass="selectBox">
                <f:selectItem itemValue="0" itemLabel="#{mobileIdBundle.NIF}" />
                <f:selectItem itemValue="1" itemLabel="#{mobileIdBundle.CIF}" />
                <f:selectItem itemValue="2" itemLabel="#{mobileIdBundle.others}" />
              </t:selectOneMenu>
              <h:outputLabel value="#{mobileIdBundle.docNum}:" for="docNum" />
              <h:inputText id="docNum" value="#{mobileIdBean.docNum}" styleClass="inputBox" />

              <t:messages styleClass="messages" errorClass="error" infoClass="info" />
              <t:div styleClass="toolbar">
                <h:commandButton value="#{mobileIdBundle.login}" action="#{mobileIdBean.beginLogin}" styleClass="button" />
                <h:outputLink value="#{loginBean.cancelURL}" styleClass="button fixed">
                  <h:outputText value="#{securityBundle.cancel}"/>
                </h:outputLink>
              </t:div>
            </t:panelGroup>

            <t:panelGroup rendered="#{mobileIdBean.waitingForPin}" styleClass="panel wait_for_pin">
              <t:outputText value="#{mobileIdBundle.enterPIN}" />
              <t:messages styleClass="messages" errorClass="error" infoClass="info" />
              <t:div styleClass="toolbar">
                <h:commandButton value="#{mobileIdBundle.pinEntered}" action="#{mobileIdBean.endLogin}" styleClass="button" />
                <h:outputLink value="#{loginBean.cancelURL}" styleClass="button fixed">
                  <h:outputText value="#{securityBundle.cancel}"/>
                </h:outputLink>
              </t:div>
            </t:panelGroup>
          
            <t:div styleClass="footer">
              <h:outputLink target="_blank" value="/accessibilitat">
                <h:outputText value="#{webBundle.accessibility}" />                
              </h:outputLink>
            </t:div>

          </t:div>
          <t:saveState value="#{mobileIdBean}" />
        </h:form>
      </h:body>
  </f:view>      
</html>

